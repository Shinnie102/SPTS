<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>PointC - Điểm danh lớp học phần</title>
    <script src="../../js/lecturer/loadComponents.js"></script>
    <link rel="stylesheet" href="../../css/lecturer/globals.css" />
    <link rel="stylesheet" href="../../css/lecturer/style.css" />
    <link rel="stylesheet" href="../../css/lecturer/grading.css" />
    <link rel="stylesheet" href="../../css/lecturer/attendance.css"/>
  </head>
  <body>
    <div class="lecturer">
      <div id="header-placeholder"></div>
      
      <!-- Placeholder cho Sidebar -->
      <div id="sidebar-placeholder"></div>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Title Section -->
        <section class="overview-section">
          <h2 class="section-title">Danh sách lớp học phần</h2>
          <p class="section-subtitle">Quản lý và theo dõi các lớp học của bạn</p>
        </section>

        <section id="lock-notification" class="lock-status-container" style="display: none;">
          <div class="lock-header-row">
            <div class="lock-text-group">
              <h3 class="lock-main-title">Khóa dữ liệu lớp học</h3>
              <p class="lock-description">Khóa dữ liệu để ngăn chỉnh sửa điểm danh và điểm số</p>
            </div>
            <div class="lock-status-icon">
              <img src="img/lock-gray.svg" alt="Lock Icon">
            </div>
          </div>

          <div class="lock-warning-banner">
            <div class="warning-icon-circle">
              <img src="img/warning-orange.svg" alt="Warning">
            </div>
            <div class="warning-text-box">
              <h4 class="warning-heading">Dữ liệu đã được khóa</h4>
              <p class="warning-detail">Sau khi khóa, bạn không thể chỉnh sửa điểm danh và điểm số. Vui lòng liên hệ quản trị viên nếu cần mở khóa.</p>
            </div>
          </div>
        </section>

        <!-- Attendance Container -->
        <div class="attendance-container">
          <!-- Hàng 1: Chọn lớp học phần -->
          <div class="class-row">
            <div class="filter-group">
              <label for="class-select">Lớp học phần</label>
              <div class="select-wrapper">
                <select id="class-select">
                  <option value="LTM101">LTM101 - Lập trình mạng</option>
                  <option value="CS101">CS101 - Cơ sở dữ liệu</option>
                  <option value="WEB101">WEB101 - Lập trình Web</option>
                </select>
                <div class="select-arrow">▼</div>
              </div>
            </div>
          </div>

          <!-- Hàng 2: Thanh điều hướng tab -->
          <div class="tab-navigation-row">
            <nav class="tab-navigation">
              <a href="attendance.html" class="tab-item">Điểm danh</a>
              <a href="grading.html" class="tab-item active">Nhập điểm</a>
              <a href="classStatus.html" class="tab-item">Trạng thái lớp</a>
              <a href="report.html" class="tab-item">Báo cáo</a>
            </nav>
          </div>

          <div class="filter-group">
            <label>Cấu trúc điểm</label>
          </div>

          <!-- Bảng Cấu trúc điểm (data-driven) -->
          <div class="structure-frame" id="structureTable">
            <!-- Sẽ được render bằng JavaScript -->
          </div>

          <div class="filter-group">
            <label>Nhập điểm</label>
          </div>

          <!-- Bảng Nhập điểm (data-driven) -->
          <div class="grade-table-frame" id="gradeTable">
            <!-- Sẽ được render bằng JavaScript -->
          </div>

          <!-- Link quay lại -->
          <div class="back-link-container">
            <a href="lecturerDashboard.html" class="back-link">← Quay lại trang chủ</a>
          </div>
        </div>
      </main>
    </div>


    <!-- JavaScript Files -->
    <script src="../../js/lecturer/dataGrading.js"></script>
    <script src="../../js/lecturer/grading.js"></script>
    <script src="../../js/lecturer/attendance.js"></script>
    <script>
      function checkClassLockStatus(classCode) {
    // 1. Tìm thông tin lớp trong mockData (giả sử dữ liệu nằm trong biến mockData)
    const currentClass = mockData.classes.find(c => c.code === classCode);
    
    const lockBox = document.getElementById('lock-notification');
    const saveBtn = document.getElementById('save-attendance-btn');
    const attendanceTable = document.getElementById('attendance-table-body');

    if (currentClass && currentClass.status === 'locked') {
        // TRƯỜNG HỢP: LỚP BỊ KHÓA
        lockBox.style.display = 'block'; // Hiện thông báo
        
        if (saveBtn) {
            saveBtn.disabled = true; // Vô hiệu hóa nút lưu
            saveBtn.style.opacity = '0.5';
            saveBtn.style.cursor = 'not-allowed';
            saveBtn.innerText = 'Dữ liệu đã khóa';
        }

        // Ngăn không cho click vào các radio/checkbox điểm danh
        if (attendanceTable) {
            attendanceTable.style.pointerEvents = 'none'; 
            attendanceTable.style.opacity = '0.8';
        }
    } else {
        // TRƯỜNG HỢP: LỚP ĐANG MỞ
        lockBox.style.display = 'none'; // Ẩn thông báo
        
        if (saveBtn) {
            saveBtn.disabled = false;
            saveBtn.style.opacity = '1';
            saveBtn.style.cursor = 'pointer';
            saveBtn.innerText = 'Lưu điểm danh';
        }

        if (attendanceTable) {
            attendanceTable.style.pointerEvents = 'auto';
            attendanceTable.style.opacity = '1';
        }
    }
}

// Gọi hàm này mỗi khi người dùng chọn một lớp mới từ menu
// Ví dụ trong sự kiện click item của menu lớp:
// item.addEventListener('click', () => {
//    const selectedClass = item.getAttribute('data-value');
//    checkClassLockStatus(selectedClass);
// });
    </script>
  </body>
</html>